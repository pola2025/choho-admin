<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>CORS μ—°κ²° μµμΆ… ν…μ¤νΈ</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding-top: 50px; }
        button { font-size: 20px; padding: 10px 20px; cursor: pointer; }
        #result { margin-top: 20px; font-weight: bold; font-size: 18px; }
        #instructions { margin-top: 30px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto; background: #f0f0f0; padding: 20px; border-radius: 8px;}
    </style>
</head>
<body>
    <h1>Google Apps Script CORS μ—°κ²° μµμΆ… ν…μ¤νΈ</h1>
    <p>μ•„λ λ²„νΌμ„ λ„λ¥΄κ³  κ²°κ³Όλ¥Ό ν™•μΈν•μ„Έμ”.</p>
    <p>(F12λ¥Ό λλ¬ κ°λ°μ μ½μ†”μ„ ν•¨κ» ν™•μΈν•μ„Έμ”)</p>
    <button id="testButton">μ—°κ²° ν…μ¤νΈ μ‹μ‘</button>
    <div id="result"></div>

    <div id="instructions">
        <h3>ν…μ¤νΈ κ²°κ³Ό μ•λ‚΄</h3>
        <ul>
            <li><strong>"π‰π‰π‰ μ—°κ²° μ„±κ³µ!" μ•λ¦Όμ°½μ΄ λ¬ κ²½μ°:</strong><br>
                CORS λ¬Έμ κ°€ μ™„μ „ν ν•΄κ²°λμ—μµλ‹λ‹¤! μ΄μ  μ΄ μ„±κ³µν• ν”„λ΅μ νΈμ— μ›λμ κ΄€λ¦¬μ κΈ°λ¥μ„ λ®μ–΄μ”μ°κ³ , <code>index.html</code>λ„ μ›λ μ½”λ“λ΅ λλλ¦¬λ©΄ 100% μ‘λ™ν•©λ‹λ‹¤.</li>
            <li><strong>"β μ‹¤ν¨!" λ©”μ‹μ§€κ°€ λ¨λ” κ²½μ°:</strong><br>
                Apps Script λ°°ν¬ μ„¤μ •(μ•΅μ„Έμ¤ κ¶ν•: λ¨λ“  μ‚¬μ©μ)μ„ λ‹¤μ‹ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤. μ½”λ“ λ¬Έμ κ°€ μ•„λ‹™λ‹λ‹¤.</li>
        </ul>
    </div>

    <script>
        // μµμΆ… ν…μ¤νΈμ© μ›Ή μ•± URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw9Fav0VorRG1ukk1StToVuBoHrPvVw_sqUGZacSuBimPbbI3f54O5in00Y6-Z91AEhtQ/exec';
        const resultDiv = document.getElementById('result');

        document.getElementById('testButton').addEventListener('click', () => {
            resultDiv.textContent = 'μ”μ²­ λ³΄λ‚΄λ” μ¤‘...';
            resultDiv.style.color = 'black';
            console.log(`μ”μ²­ μ‹μ‘: ${SCRIPT_URL}`);

            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ test: 'ping' })
            })
            .then(response => {
                console.log('μ„λ²„λ΅λ¶€ν„° μ‘λ‹µμ„ λ°›μ•μµλ‹λ‹¤. μƒνƒ μ½”λ“:', response.status);
                if (!response.ok) {
                    throw new Error(`HTTP μ—λ¬! μƒνƒ μ½”λ“: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('β… μ„±κ³µ! μ„λ²„ μ‘λ‹µ:', data);
                resultDiv.textContent = `β… μ„±κ³µ! μ„λ²„ λ©”μ‹μ§€: ${data.message}`;
                resultDiv.style.color = 'green';
                alert('π‰π‰π‰ μ—°κ²° μ„±κ³µ! λ“λ””μ–΄ CORS λ¬Έμ κ°€ ν•΄κ²°λμ—μµλ‹λ‹¤!');
            })
            .catch(error => {
                console.error('β μ‹¤ν¨! μ—λ¬:', error);
                resultDiv.textContent = `β μ‹¤ν¨! μ½μ†”μ„ ν™•μΈν•μ„Έμ”: ${error.message}`;
                resultDiv.style.color = 'red';
                alert('...μ•„μ§ μ‹¤ν¨μ…λ‹λ‹¤. μ½μ†”μ μ—λ¬ λ©”μ‹μ§€λ¥Ό λ‹¤μ‹ ν™•μΈν•΄μ£Όμ„Έμ”.');
            });
        });
    </script>
</body>
</html>
