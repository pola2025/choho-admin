<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>CORS 연결 테스트 페이지</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding-top: 50px; }
        button { font-size: 20px; padding: 10px 20px; cursor: pointer; }
        #result { margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Google Apps Script CORS 연결 테스트</h1>
    <p>아래 버튼을 누르고 결과를 확인하세요.</p>
    <p>(F12를 눌러 개발자 콘솔을 함께 확인하세요)</p>
    <button id="testButton">연결 테스트 시작</button>
    <div id="result"></div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzrUBCX_2__GsOhwpx-IKpgIjMC2pswg3fCEA3dO7aHGP0nVKVN2hSjxZpjxNnLNTel/exec';
        const resultDiv = document.getElementById('result');

        document.getElementById('testButton').addEventListener('click', () => {
            resultDiv.textContent = '요청 보내는 중...';
            resultDiv.style.color = 'black';

            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ test: 'ping' })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('✅ 성공! 서버 응답:', data);
                resultDiv.textContent = `✅ 성공! 서버 메시지: ${data.message}`;
                resultDiv.style.color = 'green';
                alert('🎉🎉🎉 연결 성공! 드디어 CORS 문제가 해결되었습니다!');
            })
            .catch(error => {
                console.error('❌ 실패! 에러:', error);
                resultDiv.textContent = `❌ 실패! 콘솔을 확인하세요: ${error.message}`;
                resultDiv.style.color = 'red';
                alert('...아직 실패입니다. 콘솔의 에러 메시지를 다시 확인해주세요.');
            });
        });
    </script>
</body>
</html>
