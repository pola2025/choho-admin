<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>CORS ì—°ê²° ìµœì¢… í…ŒìŠ¤íŠ¸ (ë³€í˜•)</title>
</head>
<body>
    <h1>CORS ì—°ê²° ìµœì¢… í…ŒìŠ¤íŠ¸ (ë³€í˜•)</h1>
    <button id="postTestButton">1. POST ë°©ì‹ í…ŒìŠ¤íŠ¸</button>
    <button id="getTestButton">2. GET ë°©ì‹ (JSONP) í…ŒìŠ¤íŠ¸</button>
    <div id="result" style="margin-top:20px; font-weight: bold;"></div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw9Fav0VorRG1ukk1StToVuBoHrPvVw_sqUGZacSuBimPbbI3f54O5in00Y6-Z91AEhtQ/exec';
        const resultDiv = document.getElementById('result');

        // 1. POST ë°©ì‹ í…ŒìŠ¤íŠ¸ (ê¸°ì¡´ ë°©ì‹)
        document.getElementById('postTestButton').addEventListener('click', () => {
            resultDiv.textContent = 'POST ìš”ì²­ ë³´ë‚´ëŠ” ì¤‘...';
            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ test: 'ping' })
            })
            .then(res => res.json())
            .then(data => {
                resultDiv.textContent = `âœ… POST ì„±ê³µ: ${data.message}`;
                alert('ğŸ‰ POST ì„±ê³µ!');
            })
            .catch(err => {
                resultDiv.textContent = `âŒ POST ì‹¤íŒ¨: ${err.message}`;
                console.error("POST Error:", err);
            });
        });

        // 2. GET ë°©ì‹ (JSONP) í…ŒìŠ¤íŠ¸
        document.getElementById('getTestButton').addEventListener('click', () => {
            resultDiv.textContent = 'GET(JSONP) ìš”ì²­ ë³´ë‚´ëŠ” ì¤‘...';
            const callbackName = 'jsonpCallback_' + new Date().getTime();

            window[callbackName] = function(data) {
                resultDiv.textContent = `âœ… GET(JSONP) ì„±ê³µ: ${data.message}`;
                alert('ğŸ‰ GET(JSONP) ì„±ê³µ!');
                delete window[callbackName];
                document.body.removeChild(script);
            };

            const script = document.createElement('script');
            script.src = `${SCRIPT_URL}?callback=${callbackName}`;
            script.onerror = () => {
                resultDiv.textContent = 'âŒ GET(JSONP) ì‹¤íŒ¨: ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì—ëŸ¬';
                console.error("JSONP Error: Script loading failed.");
            };
            document.body.appendChild(script);
        });
    </script>
</body>
</html>
